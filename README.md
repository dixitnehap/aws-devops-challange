# aws-devops-challange

This project contains source code and supporting files for a serverless application that you can deploy with the Github Actions Workflows. It includes the following files and folders.

devops-http-api - Code for the application's Lambda function. Lambda is written in Node.js. The function will return response from Get and Post HTTP method.

events - Invocation events that you can use to invoke the function.
devops-http-api/tests - Unit tests for the application code.

template.yaml - A template that defines the application's AWS resources using Cloud Formation.

.github/workflows/main.yml - main file to trigger the Github workflow. 

Note: Currently this application will create resource depending on AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY.

## Deploy AWS resources via GitHub Workflow Action (CI pipeline)
Go to the "Actions" tab on "aws-devops-challange" GitHub repository.
On left workflows panel, select "CI" GitHub Workflow.
Click on "Run workflow" by selecting main branch from the popup dialog.
The workflow will start executing the required steps to deploy the AWS Lambda function and Api Gatewy resources on AWS.
On successful execution of GitHub Workflow, Go to the "Run sam deploy" stag and check the output. 
You should see similar output like below example. Fetch the DevopsHttpApi URL from the value to test the API.

CloudFormation outputs from deployed stack
-------------------------------------------------------------------------------------------------
Outputs                                                                                         
-------------------------------------------------------------------------------------------------
Key                 DevopsHttpApiFunctionIamRole                                                
Description         Implicit IAM Role created for Devops Http Api function                      
Value               arn:aws:iam::...:role/aws-devops-challange-                        
DevopsHttpApiFunctionRole-1THEZI15VBIM3                                                         

Key                 DevopsHttpApi                                                               
Description         API Gateway endpoint URL for Prod stage for Devops Http Api function        
Value               https://0pccivschc.execute-api.eu-central-1.amazonaws.com/api              

Key                 DevopsHttpApiFunction                                                       
Description         Devops Http Api Lambda Function ARN                                         
Value               arn:aws:lambda:eu-central-1:***:function:aws-devops-challange-
DevopsHttpApiFunction-I2VfeynN4kWb                                                              
-------------------------------------------------------------------------------------------------

Successfully created/updated stack - aws-devops-challange in eu-central-1

## Test HTTP API using Postman.
Once the Devops Http Api resources are successfully deployed on AWS, you can test HTTP API using Postman or any tool which can send HTTP GET and POST request.
The HTTP API will support GET and POST methods to send Json data and in response it will return formated response with request details.

**Example Test Case**:
```
curl --header "Content-Type: application/json" --data '{"username":"xyz","password":"xyz"}' https://0pccivschc.execute-api.eu-central-1.amazonaws.com/api
```
Please note the URL in above example request should be replaced with the API URL generated by GitHub workflow.

**Example API Response**:
AWS Lamda Function Response
Welcome to our demo API, here are the details of your request:

Headers: Content-Type: application/json
Method: POST
Body: { "username": "xyz", "password": "xyz" }

NOTE: API response body type is text/html to display message as requested in challenge. This can be change to Json based on requirement.
